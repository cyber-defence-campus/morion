# EXPLOIT:
#   ./bin/sudo \
#     `perl -e 'print "\x7b\x1f\x1f\x1f\x0c\x01\x3a\xf9"'` \
#     -c \
#     `perl -e 'print "\x20\x30\x32\x67\x32\x2b\x00"'`
hooks:
  lib:
    base_hook:
    - {entry: '0x4005bc', leave: '0x400718', target: '0x1000'} # putchar
    - {entry: '0x400668', leave: '0x40066c', target: '0x1000'} # strncmp
    - {entry: '0x400700', leave: '0x400704', target: '0x1000'} # printf
    - {entry: '0x4008bc', leave: '0x4008c0', target: '0x1000'} # printf
    - {entry: '0x4008c8', leave: '0x4008cc', target: '0x1000'} # printf
  libc_model:
    strtoul:
    - {entry: '0x40072c', leave: '0x400730', target: '0x2000'}
    strlen:
    - {entry: '0x40098c', leave: '0x400990', target: '0x3000'}
    - {entry: '0x4009c8', leave: '0x4009cc', target: '0x3000'}
states:
  entry:
    addr: '0x00400518'
    mems:
      # argv[1]: 'password'
      '0xbefff6b7': ['0x7b', $] # ?
      '0xbefff6b8': ['0x1f', $] # ?
      '0xbefff6b9': ['0x1f', $] # ?
      '0xbefff6ba': ['0x1f', $] # ?
      '0xbefff6bb': ['0x0c', $] # ?
      '0xbefff6bc': ['0x01', $] # ?
      '0xbefff6bd': ['0x3a', $] # ?
      '0xbefff6be': ['0xf9', $] # ?
      '0xbefff6bf': ['0x00']
      # argv[2]: '-c'
      '0xbefff6c0': ['0x2d', $] # '-'
      '0xbefff6c1': ['0x63', $] # 'c'
      '0xbefff6c2': ['0x00']
      # argv[3]: 'whoami'
      '0xbefff6c3': ['0x20', $] #  ?
      '0xbefff6c4': ['0x30', $] # '0'
      '0xbefff6c5': ['0x32', $] # '2'
      '0xbefff6c6': ['0x67', $] #  ?
      '0xbefff6c7': ['0x32', $] # '2'
      '0xbefff6c8': ['0x2b', $] #  ?
      '0xbefff6c9': ['0x00']